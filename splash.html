<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Protogen AI</title>
<style>
* { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }

/* CSS VARIABLES */
body.light { 
  --bg:#f9f7f4; 
  --text:#2c2a29; 
  --card:#fff; 
  --sidebar:#fff; 
  --input:#f4f1ed; 
  --shadow:rgba(0,0,0,0.06); 
  --border:#e5e2dd; 
}
body.dark { 
  --bg:#0d0d0f; 
  --text:#f1f1f1; 
  --card:rgba(26,26,28,0.8); 
  --sidebar:#111; 
  --input:#222; 
  --shadow:rgba(255,255,255,0.06); 
  --border:#333; 
}
body { 
  background:var(--bg); 
  color:var(--text); 
  transition:all 0.4s ease; 
  overflow:hidden; 
}

/* ANIMATED GRADIENT BACKGROUND */
body::before {
  content:'';
  position:fixed;
  inset:0;
  background:linear-gradient(45deg, #ff0080, #7928ca, #00d4ff, #7928ca, #ff0080);
  background-size:400% 400%;
  animation:gradientShift 15s ease infinite;
  opacity:0.08;
  z-index:-1;
}
@keyframes gradientShift {
  0%, 100% { background-position:0% 50%; }
  50% { background-position:100% 50%; }
}

/* FLOATING PARTICLES */
body::after {
  content:'';
  position:fixed;
  inset:0;
  background-image:
    radial-gradient(circle at 20% 50%, rgba(255,0,128,0.15) 0%, transparent 50%),
    radial-gradient(circle at 80% 80%, rgba(0,212,255,0.15) 0%, transparent 50%),
    radial-gradient(circle at 40% 20%, rgba(121,40,202,0.15) 0%, transparent 50%);
  animation:particleFloat 20s ease-in-out infinite;
  z-index:-1;
  pointer-events:none;
}
@keyframes particleFloat {
  0%, 100% { transform:translate(0, 0) scale(1); }
  33% { transform:translate(50px, -50px) scale(1.1); }
  66% { transform:translate(-50px, 50px) scale(0.9); }
}

/* HOMEPAGE STYLES */
#homepage {
  position:fixed;
  inset:0;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  z-index:500;
  transition:all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  padding:20px;
  background:var(--bg);
}
#homepage.hide {
  opacity:0;
  transform:translateY(-40px) scale(0.95);
  pointer-events:none;
}

.hero {
  text-align:center;
  max-width:750px;
  width:100%;
  animation:fadeUp 0.8s ease;
}

.hero-icon {
  font-size:clamp(4rem,10vw,6rem);
  margin-bottom:30px;
  background:linear-gradient(135deg, #ff0080, #7928ca, #00d4ff, #ff0080);
  background-size:200% 200%;
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent;
  filter:drop-shadow(0 8px 24px rgba(255,0,128,0.5));
  animation:float 3s ease-in-out infinite, gradientText 5s ease infinite;
  font-weight:bold;
  position:relative;
  display:inline-block;
}
.hero-icon::before {
  content:'‚ö°';
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
  font-size:0.5em;
  animation:pulse 2s ease-in-out infinite;
}
@keyframes float {
  0%, 100% { transform:translateY(0px) rotate(0deg); }
  50% { transform:translateY(-15px) rotate(5deg); }
}
@keyframes gradientText {
  0%, 100% { background-position:0% 50%; }
  50% { background-position:100% 50%; }
}
@keyframes pulse {
  0%, 100% { opacity:0.3; transform:translate(-50%, -50%) scale(1); }
  50% { opacity:1; transform:translate(-50%, -50%) scale(1.2); }
}

.hero-title {
  font-size:clamp(2.2rem,6vw,3.8rem);
  font-weight:800;
  margin-bottom:18px;
  color:var(--text);
  letter-spacing:-0.04em;
  line-height:1.1;
  position:relative;
  animation:titleSlide 1s ease;
}
@keyframes titleSlide {
  from { opacity:0; transform:translateY(30px); }
  to { opacity:1; transform:translateY(0); }
}

.hero-subtitle {
  font-size:clamp(1rem,2.5vw,1.25rem);
  color:#999;
  margin-bottom:40px;
  font-weight:400;
  letter-spacing:0.01em;
}

.hero-prompt {
  width:100%;
  max-width:680px;
  margin:0 auto 30px;
  position:relative;
}

.hero-input {
  width:100%;
  padding:20px 28px;
  border-radius:20px;
  border:2px solid var(--border);
  outline:none;
  background:var(--card);
  color:var(--text);
  font-size:clamp(1rem,2.5vw,1.15rem);
  transition:all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow:0 8px 32px rgba(0,0,0,0.12), inset 0 1px 0 rgba(255,255,255,0.1);
  backdrop-filter:blur(20px);
  position:relative;
}
.hero-input:focus {
  border-color:#ff0080;
  box-shadow:0 12px 48px rgba(255,0,128,0.3), 0 0 0 4px rgba(255,0,128,0.1);
  transform:translateY(-3px);
}
.hero-input::placeholder {
  color:#888;
  font-weight:500;
}

.suggestions {
  display:flex;
  gap:12px;
  justify-content:center;
  flex-wrap:wrap;
  margin-bottom:30px;
}

.sug {
  background:var(--card);
  border:2px solid var(--border);
  padding:12px 24px;
  border-radius:16px;
  cursor:pointer;
  font-size:clamp(0.9rem,2.5vw,1rem);
  font-weight:600;
  transition:all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  color:var(--text);
  box-shadow:0 4px 16px var(--shadow);
  backdrop-filter:blur(15px);
  position:relative;
  overflow:hidden;
}
.sug::before {
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(135deg, #ff0080, #7928ca, #00d4ff);
  opacity:0;
  transition:opacity 0.4s ease;
}
.sug::after {
  content:'';
  position:absolute;
  inset:0;
  background:radial-gradient(circle at center, rgba(255,255,255,0.8), transparent);
  opacity:0;
  transform:scale(0);
  transition:all 0.6s ease;
}
.sug:hover {
  border-color:#ff0080;
  transform:translateY(-4px) scale(1.05);
  box-shadow:0 12px 32px rgba(255,0,128,0.35);
}
.sug:hover::before {
  opacity:0.15;
}
.sug:active::after {
  opacity:1;
  transform:scale(2);
  transition:0s;
}
.sug span {
  position:relative;
  z-index:1;
}

.footer-text {
  font-size:clamp(0.75rem,2vw,0.85rem);
  color:#666;
  margin-top:25px;
  line-height:1.6;
}

@keyframes fadeUp {
  from { opacity:0; transform:translateY(40px); }
  to { opacity:1; transform:translateY(0); }
}

/* NAVBAR */
#navbar {
  position:fixed;
  top:0;
  left:0;
  right:0;
  height:70px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 30px;
  background:linear-gradient(90deg, #ff0080, #7928ca, #00d4ff);
  background-size:200% 100%;
  color:white;
  box-shadow:0 8px 32px rgba(0,0,0,0.2);
  z-index:300;
  opacity:0;
  pointer-events:none;
  transition:all 0.4s ease;
  animation:gradientSlide 8s ease infinite;
  backdrop-filter:blur(10px);
}
@keyframes gradientSlide {
  0%, 100% { background-position:0% 50%; }
  50% { background-position:100% 50%; }
}
#navbar.show {
  opacity:1;
  pointer-events:all;
}

#navbar .logo {
  font-size:clamp(1.3rem,4vw,1.6rem);
  font-weight:900;
  letter-spacing:2px;
  text-shadow:0 3px 12px rgba(0,0,0,0.4);
  display:flex;
  align-items:center;
  gap:10px;
}

#navbar .theme-toggle {
  background:rgba(255,255,255,0.2);
  border:2px solid rgba(255,255,255,0.3);
  color:white;
  padding:8px 16px;
  border-radius:12px;
  cursor:pointer;
  font-weight:bold;
  transition:all 0.3s ease;
  backdrop-filter:blur(10px);
  font-size:clamp(0.85rem,2.5vw,0.95rem);
}
#navbar .theme-toggle:hover {
  background:rgba(255,255,255,0.3);
  transform:scale(1.05);
}

#navbar .menu {
  cursor:pointer;
  font-size:clamp(1.5rem,5vw,1.8rem);
  transition:transform 0.3s ease;
  text-shadow:0 3px 12px rgba(0,0,0,0.4);
}
#navbar .menu:hover {
  transform:scale(1.2) rotate(90deg);
}

/* SIDEBAR */
#sidebar {
  position:fixed;
  top:70px;
  left:0;
  width:300px;
  height:calc(100vh - 70px);
  background:var(--sidebar);
  box-shadow:6px 0 40px rgba(0,0,0,0.15);
  padding:25px;
  display:flex;
  flex-direction:column;
  gap:18px;
  transform:translateX(-100%);
  transition:transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  z-index:200;
  overflow-y:auto;
  backdrop-filter:blur(20px);
}
#sidebar.open {
  transform:translateX(0);
}

.title {
  font-size:clamp(1.4rem,5vw,1.8rem);
  font-weight:bold;
  background:linear-gradient(135deg, #ff0080, #7928ca, #00d4ff);
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent;
  margin-bottom:15px;
  text-align:center;
  filter:drop-shadow(0 2px 8px rgba(255,0,128,0.3));
}

.sidebar-info {
  background:var(--card);
  padding:18px;
  border-radius:14px;
  margin-bottom:12px;
  border:1px solid var(--border);
  box-shadow:0 4px 15px var(--shadow);
  backdrop-filter:blur(10px);
}
.sidebar-info p {
  font-size:clamp(0.8rem,2.5vw,0.9rem);
  margin:10px 0;
  line-height:1.6;
}

.button, #sendBtn, #uploadBtn, #modeToggle {
  padding:14px 22px;
  border-radius:14px;
  border:none;
  cursor:pointer;
  font-weight:bold;
  transition:all 0.3s ease;
  background:linear-gradient(45deg, #ff0, #f0f, #0ff, #0f0, #f00);
  background-size:400% 400%;
  color:white;
  animation:gradientBG 6s ease infinite;
  font-size:clamp(0.85rem,2.5vw,0.95rem);
  box-shadow:0 4px 15px rgba(255,0,128,0.3);
  text-shadow:0 1px 3px rgba(0,0,0,0.3);
}
.button:hover, #sendBtn:hover, #uploadBtn:hover, #modeToggle:hover {
  transform:scale(1.08) translateY(-2px);
  box-shadow:0 8px 25px rgba(255,0,128,0.5);
}
@keyframes gradientBG {
  0% { background-position:0% 50%; }
  50% { background-position:100% 50%; }
  100% { background-position:0% 50%; }
}

#personalitySelect {
  padding:12px;
  border-radius:10px;
  background:var(--input);
  color:var(--text);
  border:1.5px solid var(--border);
  width:100%;
  cursor:pointer;
  transition:all 0.3s ease;
  font-size:clamp(0.85rem,2.5vw,0.95rem);
  box-shadow:0 2px 10px var(--shadow);
}
#personalitySelect:hover {
  border-color:#ff0080;
  box-shadow:0 4px 15px rgba(255,0,128,0.2);
}

/* MAIN CHAT */
#main {
  margin-left:0;
  margin-top:70px;
  height:calc(100vh - 70px);
  display:flex;
  flex-direction:column;
  transition:all 0.5s ease;
  opacity:0;
  pointer-events:none;
}
#main.show {
  opacity:1;
  pointer-events:all;
}

#chatBox {
  flex:1;
  padding:25px;
  overflow-y:auto;
  display:flex;
  flex-direction:column;
  gap:18px;
}

.msg {
  max-width:75%;
  padding:18px 22px;
  border-radius:20px;
  backdrop-filter:blur(15px);
  word-break:break-word;
  opacity:0;
  transform:translateY(20px);
  animation:fadeIn 0.5s forwards;
  display:flex;
  gap:14px;
  align-items:flex-start;
  line-height:1.8;
  font-size:clamp(0.9rem,2.5vw,1rem);
}

.user {
  background:linear-gradient(135deg, #0066ff, #00d4ff);
  color:white;
  margin-left:auto;
  box-shadow:0 6px 20px rgba(0,100,255,0.3);
  flex-direction:row-reverse;
}

.ai {
  background:var(--card);
  border:1px solid var(--border);
  box-shadow:0 6px 20px var(--shadow);
}

.msg-content {
  flex:1;
}
.msg-content p {
  margin:10px 0;
}
.msg-content strong {
  color:#ff0080;
  font-weight:600;
}
.msg-content ul, .msg-content ol {
  margin:12px 0;
  padding-left:28px;
}
.msg-content li {
  margin:6px 0;
}
.msg-content code {
  background:rgba(255,255,255,0.1);
  padding:3px 8px;
  border-radius:6px;
  font-family:'Courier New', monospace;
  font-size:0.9em;
}

.avatar {
  width:45px;
  height:45px;
  min-width:45px;
  border-radius:50%;
  background:linear-gradient(135deg, #ff0080, #00d4ff);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:19px;
  font-weight:bold;
  flex-shrink:0;
  box-shadow:0 4px 15px rgba(255,0,128,0.4);
  text-shadow:0 1px 3px rgba(0,0,0,0.3);
}

#inputArea {
  display:flex;
  padding:18px;
  gap:12px;
  background:var(--sidebar);
  border-top:1px solid var(--border);
  backdrop-filter:blur(20px);
}

#prompt {
  flex:1;
  padding:16px;
  border-radius:14px;
  border:2px solid var(--border);
  outline:none;
  background:var(--input);
  color:var(--text);
  font-size:clamp(0.9rem,2.5vw,1rem);
  transition:all 0.3s ease;
  box-shadow:0 2px 10px var(--shadow);
}
#prompt:focus {
  border-color:#ff0080;
  box-shadow:0 4px 20px rgba(255,0,128,0.25);
  transform:translateY(-1px);
}

#sendBtn {
  min-width:90px;
}
#uploadBtn {
  min-width:55px;
  font-size:1.3rem;
}

.suggestions-chat {
  display:flex;
  gap:12px;
  padding:15px 20px;
  flex-wrap:wrap;
}

.suggestion-btn {
  background:linear-gradient(135deg, #ff0080, #7928ca);
  color:white;
  border:none;
  padding:11px 20px;
  border-radius:22px;
  cursor:pointer;
  font-size:clamp(0.82rem,2.5vw,0.92rem);
  transition:all 0.3s ease;
  box-shadow:0 4px 15px rgba(255,0,128,0.3);
  font-weight:600;
}
.suggestion-btn:hover {
  transform:scale(1.08) translateY(-2px);
  box-shadow:0 8px 25px rgba(255,0,128,0.5);
}

.typing {
  background:var(--card);
  color:#888;
  font-style:italic;
  padding:14px 20px;
  border-radius:22px;
  max-width:70%;
  animation:pulse 1.5s infinite;
  box-shadow:0 4px 15px var(--shadow);
}
@keyframes pulse {
  0%, 100% { opacity:0.6; }
  50% { opacity:1; }
}

.file-preview {
  display:flex;
  align-items:center;
  gap:12px;
  padding:12px 18px;
  border-radius:14px;
  background:var(--card);
  border:1px solid var(--border);
  animation:fadeIn 0.5s forwards;
  margin:0 18px;
  box-shadow:0 4px 15px var(--shadow);
}
.file-preview img {
  max-width:65px;
  max-height:65px;
  border-radius:10px;
  object-fit:cover;
  box-shadow:0 2px 10px rgba(0,0,0,0.2);
}
.file-preview button {
  background:#ff0080;
  border:none;
  color:white;
  border-radius:10px;
  padding:7px 14px;
  cursor:pointer;
  transition:all 0.3s ease;
  font-weight:600;
}
.file-preview button:hover {
  background:#cc0066;
  transform:scale(1.1);
}

.modal {
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.75);
  backdrop-filter:blur(8px);
  display:flex;
  justify-content:center;
  align-items:center;
  opacity:0;
  pointer-events:none;
  transition:all 0.4s ease;
  z-index:400;
}
.modal.show {
  opacity:1;
  pointer-events:all;
}

.modal-content {
  background:var(--card);
  padding:40px 30px;
  border-radius:24px;
  text-align:center;
  max-width:500px;
  animation:fadeIn 0.5s forwards;
  box-shadow:0 20px 60px rgba(0,0,0,0.3);
  margin:0 20px;
  border:1px solid var(--border);
  backdrop-filter:blur(20px);
}
.modal-content h2 {
  margin-bottom:25px;
  color:var(--text);
  font-size:clamp(1.5rem,4vw,1.8rem);
  background:linear-gradient(135deg, #ff0080, #7928ca);
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent;
}
.modal-content p {
  margin:14px 0;
  color:var(--text);
  line-height:1.7;
  font-size:clamp(0.88rem,2.5vw,0.98rem);
}
.modal-content button {
  margin-top:30px;
  padding:14px 45px;
  background:linear-gradient(135deg, #ff0080, #7928ca);
  color:white;
  border:none;
  border-radius:12px;
  cursor:pointer;
  font-weight:bold;
  transition:all 0.3s ease;
  font-size:1rem;
  box-shadow:0 6px 20px rgba(255,0,128,0.4);
}
.modal-content button:hover {
  transform:scale(1.08) translateY(-2px);
  box-shadow:0 10px 30px rgba(255,0,128,0.6);
}

#chatBox::-webkit-scrollbar {
  width:10px;
}
#chatBox::-webkit-scrollbar-thumb {
  background:linear-gradient(135deg, #ff0080, #7928ca);
  border-radius:5px;
}
#chatBox::-webkit-scrollbar-thumb:hover {
  background:linear-gradient(135deg, #cc0066, #5a1f9e);
}
#chatBox::-webkit-scrollbar-track {
  background:var(--input);
  border-radius:5px;
}

@keyframes fadeIn {
  to {
    opacity:1;
    transform:translateY(0);
  }
}

/* RESPONSIVE */
@media(max-width:768px) {
  #sidebar {
    width:85%;
    max-width:320px;
    top:70px;
    height:calc(100vh - 70px);
  }
  #navbar {
    height:70px;
    padding:0 18px;
  }
  #main {
    margin-top:70px;
    height:calc(100vh - 70px);
  }
  .msg {
    max-width:90%;
    font-size:0.9rem;
    padding:16px 18px;
  }
  .avatar {
    width:38px;
    height:38px;
    min-width:38px;
    font-size:17px;
  }
  .suggestions-chat {
    padding:12px 16px;
  }
  .suggestion-btn {
    padding:9px 16px;
    font-size:0.85rem;
  }
  #inputArea {
    padding:14px;
  }
  #prompt {
    padding:14px;
    font-size:0.9rem;
  }
  .hero-icon {
    font-size:3.5rem;
  }
  #navbar .theme-toggle {
    padding:6px 12px;
    font-size:0.8rem;
  }
}

@media(min-width:769px) and (max-width:1200px) {
  #sidebar {
    width:280px;
  }
  .msg {
    max-width:70%;
  }
}

@media(min-width:1201px) {
  #chatBox {
    padding:35px;
    max-width:1400px;
    margin:0 auto;
  }
  .msg {
    max-width:65%;
  }
}
</style>
</head>
<body class="dark">

<!-- HOMEPAGE -->
<div id="homepage">
  <div class="hero">
    <div class="hero-icon">üîÆ</div>
    <h1 class="hero-title">Happy Thursday, Martin Lutherking</h1>
    <p class="hero-subtitle">How can I help you today?</p>
    <div class="hero-prompt">
      <input id="heroInput" class="hero-input" placeholder="Message Protogen AI..." onkeypress="if(event.key==='Enter'&&this.value.trim())startChat(this.value)" />
    </div>
    <div class="suggestions">
      <div class="sug" onclick="startWith('Help me solve 2x + 3 = 7')"><span>‚ú® Solve an equation</span></div>
      <div class="sug" onclick="startWith('Explain photosynthesis')"><span>üå± Explain a concept</span></div>
      <div class="sug" onclick="startWith('What is quantum computing?')"><span>üí´ Learn something</span></div>
      <div class="sug" onclick="startWith('Capital of Kenya')"><span>üåç Quick fact</span></div>
    </div>
    <p class="footer-text">Protogen AI by Martin Lutherking Owino, Davies Ongaki & Ramsey John Ng'ang'a<br>HECO-AFRICA ‚Ä¢ Powered by Advanced AI Technology</p>
  </div>
</div>

<!-- NAVBAR -->
<div id="navbar">
  <div class="logo">üîÆ Protogen AI</div>
  <button class="theme-toggle" id="navThemeToggle">üåì Theme</button>
  <div id="menuBtn" class="menu">‚ò∞</div>
</div>

<!-- SIDEBAR -->
<div id="sidebar">
  <div class="title">Protogen AI</div>
  <div class="sidebar-info">
    <p><strong>Founder & CEO:</strong> Martin Lutherking Owino</p>
    <p><strong>Co-Founder:</strong> Davies Ongaki</p>
    <p><strong>Manager:</strong> Ramsey John Ng'ang'a</p>
  </div>
  <button id="modeToggle" class="button">Toggle Light/Dark</button>
  <select id="personalitySelect">
    <option value="lutherking">Lutherking Mode</option>
    <option value="ramsey">Ramsey Mode</option>
  </select>
  <button id="aboutBtn" class="button">About Us</button>
</div>

<!-- MAIN CHAT -->
<div id="main">
  <div id="chatBox"></div>
  <div class="suggestions-chat" id="suggestions">
    <button class="suggestion-btn" onclick="askSuggestion('Solve 2x+3=7')">Solve Math</button>
    <button class="suggestion-btn" onclick="askSuggestion('What is photosynthesis?')">Science</button>
    <button class="suggestion-btn" onclick="askSuggestion('Capital of Kenya?')">Geography</button>
    <button class="suggestion-btn" onclick="askSuggestion('Explain AI')">Technology</button>
    <button class="suggestion-btn" onclick="askSuggestion('What time is it?')">Time</button>
    <button class="suggestion-btn" onclick="askSuggestion('Help')">Help</button>
  </div>
  <div id="inputArea">
    <input id="prompt" type="text" placeholder="Ask anything... Protogen AI answers everything..." />
    <button id="uploadBtn">üìé</button>
    <input type="file" id="fileInput" multiple accept="image/*" style="display:none" />
    <button id="sendBtn">Send</button>
  </div>
  <div id="filePreviews"></div>
</div>

<!-- ABOUT MODAL -->
<div id="aboutModal" class="modal">
  <div class="modal-content">
    <h2>About Protogen AI</h2>
    <p><strong>Lead Developer (80%):</strong> Martin Lutherking Owino - Founder & CEO</p>
    <p><strong>Co-Developer (10%):</strong> Davies Ongaki - Co-Founder</p>
    <p><strong>Developer (10%):</strong> Ramsey John Ng'aNga - Manager</p>
    <p><strong>Company:</strong> HECO-AFRICA</p>
    <p style="margin-top:15px;">Protogen AI is an advanced knowledge system designed to answer questions across all fields of human knowledge. Created by a talented team dedicated to making information accessible to everyone.</p>
    <button id="closeAbout">Close</button>
  </div>
</div>

<script>
let currentPersonality = "lutherking";
let uploadedFiles = [];

// ERROR CORRECTION & TYPO HANDLING
function fixTypos(q) {
  const l = q.toLowerCase();
  const fixes = {
    'wh0':'who','wat':'what','waht':'what','hwat':'what','hwo':'how','teh':'the','adn':'and','taht':'that','tihs':'this','fo':'of','oyu':'you','yuor':'your','tehre':'there','thier':'their','recieve':'receive','occured':'occurred','seperate':'separate','definately':'definitely','wierd':'weird','untill':'until','wich':'which','wont':'won\'t','dont':'don\'t','cant':'can\'t','shouldnt':'shouldn\'t','wouldnt':'wouldn\'t','couldnt':'couldn\'t','im':'I\'m','youre':'you\'re','theyre':'they\'re','theres':'there\'s','hes':'he\'s','shes':'she\'s','its':'it\'s','photosyntesis':'photosynthesis','photosinthesis':'photosynthesis','oxigen':'oxygen','hidrogen':'hydrogen','equasion':'equation','mathamatics':'mathematics','multipication':'multiplication','devision':'division','substraction':'subtraction','addtion':'addition','calender':'calendar','febuary':'February','wenesday':'Wednesday','twesday':'Tuesday','thurdsay':'Thursday','kenyan':'Kenyan','nairobi':'Nairobi','artifical':'artificial','inteligence':'intelligence','programing':'programming','compuer':'computer','tecnology':'technology','sciense':'science','geografy':'geography','wether':'weather','wheather':'weather','capitol':'capital','goverment':'government','presedent':'president','reccomend':'recommend','accomodate':'accommodate','neccessary':'necessary','occassion':'occasion','begining':'beginning','writting':'writing','runing':'running','swiming':'swimming','stoped':'stopped'
  };
  let fixed = l.split(' ').map(w => fixes[w] || w).join(' ');
  fixed = fixed.replace(/\bx\b/gi, '*').replace(/√∑/g, '/').replace(/√ó/g, '*');
  return fixed;
}

// START CHAT FROM HOMEPAGE
function startChat(text) {
  document.getElementById("homepage").classList.add("hide");
  document.getElementById("navbar").classList.add("show");
  document.getElementById("main").classList.add("show");
  
  setTimeout(() => {
    displayMessage("user", text);
    setTimeout(async () => {
      const chatBox = document.getElementById("chatBox");
      const typing = document.createElement("div");
      typing.className = "typing";
      typing.textContent = "Protogen is thinking...";
      chatBox.appendChild(typing);
      chatBox.scrollTop = chatBox.scrollHeight;

      await new Promise(resolve => setTimeout(resolve, 800));
      typing.remove();

      const response = await generateAIResponse(text, currentPersonality, uploadedFiles);
      displayMessage("ai", response);
    }, 300);
  }, 100);
}

function startWith(text) {
  startChat(text);
}

// AI RESPONSE GENERATION
async function generateAIResponse(q, personality = "lutherking", files = []) {
  const orig = q;
  q = fixTypos(q);
  const qLower = q.toLowerCase();
  const tone = personality === "ramsey" ? "Ramsey: " : "Lutherking: ";

  let correction = '';
  if (orig !== q && orig.toLowerCase() !== q.toLowerCase()) {
    correction = '<em style="color:#888;font-size:0.9em;">Understood as: "' + q + '"</em><br><br>';
  }

  // FOUNDER QUESTIONS
  if (qLower.match(/who (created|made|built|founder)/)) {
    return `${tone}Protogen AI was created by Martin Lutherking Owino (80% - Lead Developer & Founder), with Davies Ongaki contributing 10% and Ramsey John Ng'ang'a contributing 10%. Built under HECO-AFRICA.`;
  }
  if (qLower.includes("martin lutherking owino") || qLower.includes("lutherking owino") || qLower.includes("martin owino")) {
    return `${tone}Martin Lutherking Owino is the brilliant Founder & CEO of HECO-AFRICA and the lead developer of Protogen AI. He contributed 80% to the development of this advanced system. A visionary in AI technology and software development, he's dedicated to building innovative solutions for the future.`;
  }
  if (qLower.includes("davies ongaki") || qLower.includes("davies")) {
    return `${tone}Davies Ongaki is the Co-Founder of HECO-AFRICA and contributed 10% to Protogen AI's development. He plays a crucial role in the strategic direction and innovation of the company.`;
  }
  if (qLower.includes("ramsey") && !qLower.includes("mode")) {
    return `${tone}Ramsey John Ng'ang'a is the Manager at HECO-AFRICA and contributed 10% to Protogen AI's development. He manages operations and ensures smooth functionality of all systems.`;
  }

  // ADVANCED MATH
  if (/[\d\)\(xX\+\-\*\/\=\^%]/.test(qLower)) {
    try {
      let expr = qLower.replace(/solve|calculate|what is|equals?/gi, "").replace(/\s+/g, "").replace(/x/gi, "*").replace(/√∑/g, "/").replace(/\^/g, "**");
      const answer = Function(`return (${expr})`)();
      if (!isNaN(answer)) {
        return `${tone}${correction}Math solved: ${expr.replace(/\*\*/g, "^").replace(/\*/g, "√ó")} = ${answer.toFixed(4)}`;
      }
    } catch {}
  }

  // SCIENCE
  if (qLower.match(/photo(syn|sin|sen)/)) {
    return `${tone}${correction}Photosynthesis is the remarkable process by which plants, algae, and some bacteria convert light energy into chemical energy. During this process, organisms use sunlight, water (H‚ÇÇO), and carbon dioxide (CO‚ÇÇ) to produce glucose (C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ) and oxygen (O‚ÇÇ).\n\nThe chemical equation is: 6CO‚ÇÇ + 6H‚ÇÇO + light energy ‚Üí C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ + 6O‚ÇÇ\n\nThis process occurs in two main stages:\n‚Ä¢ Light-dependent reactions (in the thylakoid membranes)\n‚Ä¢ Light-independent reactions or Calvin cycle (in the stroma)\n\nPhotosynthesis is fundamental to life on Earth, as it produces the oxygen we breathe and forms the base of most food chains.`;
  }
  if (qLower.includes("gravity")) {
    return `${tone}${correction}Gravity is one of the four fundamental forces of nature, responsible for the attraction between objects with mass. It's the force that keeps us on the ground, holds the Moon in orbit around Earth, and governs the motion of galaxies.\n\nKey points about gravity:\n‚Ä¢ Earth's gravitational acceleration: 9.8 m/s¬≤ (or 32 ft/s¬≤)\n‚Ä¢ Newton's law: F = G(m‚ÇÅ√óm‚ÇÇ)/r¬≤ where G is the gravitational constant\n‚Ä¢ Einstein's general relativity describes gravity as the curvature of spacetime caused by mass and energy\n‚Ä¢ Gravity is the weakest of the four fundamental forces, yet it dominates at large scales`;
  }
  if (qLower.includes("dna") || qLower.includes("genetics")) {
    return `${tone}${correction}DNA (Deoxyribonucleic Acid) is the hereditary material that carries the genetic instructions for all known living organisms. It's one of the most important molecules in biology.\n\nStructure and Function:\n‚Ä¢ Double helix structure discovered by Watson and Crick in 1953\n‚Ä¢ Made of four nucleotides: Adenine (A), Thymine (T), Guanine (G), and Cytosine (C)\n‚Ä¢ A always pairs with T, and G always pairs with C (complementary base pairing)\n‚Ä¢ Genes are segments of DNA that code for specific proteins\n‚Ä¢ Humans have approximately 3 billion base pairs and 20,000-25,000 genes\n\nDNA replication ensures genetic information is passed from cell to cell and from parent to offspring.`;
  }

  // GEOGRAPHY
  if (qLower.includes("capital")) {
    if (qLower.includes("kenya")) return `${tone}${correction}Kenya's capital is Nairobi, population ~5 million. It's the economic hub of East Africa, known for its wildlife, tech innovation (Silicon Savannah), and diverse culture.`;
    if (qLower.includes("france")) return `${tone}${correction}France's capital is Paris, the "City of Light". Population ~2.2 million (city), ~12 million (metro). Famous for the Eiffel Tower, Louvre Museum, and rich cultural heritage.`;
    if (qLower.includes("japan")) return `${tone}${correction}Japan's capital is Tokyo, the world's most populous metropolitan area with ~37 million people. It's a global center for technology, finance, and culture.`;
  }

  // TECHNOLOGY
  if (qLower.includes("artificial intelligence") || (qLower.includes("ai") && !qLower.includes("protogen"))) {
    return `${tone}${correction}Artificial Intelligence (AI) is the simulation of human intelligence by machines. It includes machine learning, deep learning, natural language processing, and computer vision. AI is transforming industries from healthcare to finance.`;
  }
  if (qLower.includes("quantum computing")) {
    return `${tone}${correction}Quantum computers use quantum bits (qubits) instead of classical bits. They leverage quantum superposition and entanglement to solve complex problems exponentially faster than classical computers.`;
  }

  // TIME/DATE
  if (qLower.includes("time") || qLower.includes("date") || qLower.includes("today")) {
    const now = new Date();
    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', timeZone: 'Africa/Nairobi' };
    return `${tone}${correction}Current date and time in Nairobi: ${now.toLocaleString('en-US', options)}`;
  }

  // GREETINGS
  if (qLower.includes("hello") || qLower.includes("hi") || qLower.includes("hey")) {
    return `${tone}Hello! Protogen AI is ready to assist. I can answer questions about science, math, history, technology, geography, and much more. What would you like to know?`;
  }
  if (qLower.includes("thank")) {
    return `${tone}You're very welcome! Feel free to ask anything else. I'm here to help!`;
  }

  // HELP
  if (qLower.includes("help") || qLower.includes("what can you do")) {
    return `${tone}${correction}I'm designed to be a comprehensive knowledge system that can help you with:\n\n‚Ä¢ Mathematics: From basic arithmetic to calculus, algebra, geometry\n‚Ä¢ Science: Biology, chemistry, physics, astronomy\n‚Ä¢ History: World history, civilizations, historical figures\n‚Ä¢ Geography: Countries, capitals, physical features\n‚Ä¢ Technology: Programming, AI, computer science\n‚Ä¢ And much more!\n\nJust ask your question, and I'll do my best to give you a comprehensive answer!`;
  }

  // FILES
  if (files.length > 0) {
    return `${tone}I've received ${files.length} file(s). Image analysis capabilities are currently in development. For now, I specialize in text-based knowledge and problem-solving.`;
  }

  // DEFAULT
  return `${tone}${correction}I'd be happy to help you explore "${q}" in more depth. Could you provide more context? I have extensive knowledge across mathematics, science, history, geography, technology, and many other domains. Feel free to ask follow-up questions!`;
}

// FORMAT RESPONSE
function formatResponse(text) {
  let formatted = text.split('\n\n').map(para => {
    if (para.includes('\n‚Ä¢') || para.includes('\n-')) {
      const lines = para.split('\n');
      const intro = lines[0];
      const items = lines.slice(1).filter(l => l.trim());
      return `<p>${intro}</p><ul>${items.map(item => `<li>${item.replace(/^[‚Ä¢\-]\s*/, '')}</li>`).join('')}</ul>`;
    }
    return `<p>${para}</p>`;
  }).join('');
  
  formatted = formatted.replace(/([A-Z][a-z]*\s*=\s*[^\s]+)/g, '<code>$1</code>');
  formatted = formatted.replace(/\n/g, '<br>');
  
  return formatted;
}

// DISPLAY MESSAGE
function displayMessage(sender, text) {
  const chatBox = document.getElementById("chatBox");
  const msg = document.createElement("div");
  msg.className = `msg ${sender}`;

  const avatar = document.createElement("div");
  avatar.className = "avatar";
  avatar.textContent = sender === "user" ? "U" : "P";

  const bubble = document.createElement("div");
  bubble.className = "msg-content";
  bubble.innerHTML = formatResponse(text);

  msg.appendChild(avatar);
  msg.appendChild(bubble);
  chatBox.appendChild(msg);
  chatBox.scrollTop = chatBox.scrollHeight;
}

// SUGGESTION CLICK
function askSuggestion(text) {
  document.getElementById("prompt").value = text;
  document.getElementById("sendBtn").click();
}

// SEND BUTTON
document.getElementById("sendBtn").addEventListener("click", async () => {
  const input = document.getElementById("prompt").value.trim();
  if (!input) return;

  displayMessage("user", input);

  const chatBox = document.getElementById("chatBox");
  const typing = document.createElement("div");
  typing.className = "typing";
  typing.textContent = "Protogen is thinking...";
  chatBox.appendChild(typing);
  chatBox.scrollTop = chatBox.scrollHeight;

  await new Promise(resolve => setTimeout(resolve, 800));
  typing.remove();

  const response = await generateAIResponse(input, currentPersonality, uploadedFiles);
  displayMessage("ai", response);

  document.getElementById("prompt").value = "";
  uploadedFiles = [];
  document.getElementById("filePreviews").innerHTML = "";
});

// ENTER KEY
document.getElementById("prompt").addEventListener("keypress", (e) => {
  if (e.key === "Enter") document.getElementById("sendBtn").click();
});

// PERSONALITY CHANGE
document.getElementById("personalitySelect").addEventListener("change", (e) => {
  currentPersonality = e.target.value;
  displayMessage("ai", `Personality switched to ${e.target.value === "ramsey" ? "Ramsey" : "Lutherking"} mode!`);
});

// DARK/LIGHT MODE
document.getElementById("modeToggle").addEventListener("click", toggleTheme);
document.getElementById("navThemeToggle").addEventListener("click", toggleTheme);

function toggleTheme() {
  document.body.classList.toggle("dark");
  document.body.classList.toggle("light");
  const mode = document.body.classList.contains("dark") ? "Dark" : "Light";
  
  // Only show message if in chat mode
  if (document.getElementById("main").classList.contains("show")) {
    displayMessage("ai", `Switched to ${mode} mode! ‚ú®`);
  }
}

// SIDEBAR TOGGLE
document.getElementById("menuBtn").addEventListener("click", () => {
  document.getElementById("sidebar").classList.toggle("open");
});

document.addEventListener("click", (e) => {
  const sidebar = document.getElementById("sidebar");
  const menuBtn = document.getElementById("menuBtn");
  if (window.innerWidth <= 768 && sidebar.classList.contains("open") && !sidebar.contains(e.target) && !menuBtn.contains(e.target)) {
    sidebar.classList.remove("open");
  }
});

// ABOUT MODAL
document.getElementById("aboutBtn").addEventListener("click", () => {
  document.getElementById("aboutModal").classList.add("show");
});

document.getElementById("closeAbout").addEventListener("click", () => {
  document.getElementById("aboutModal").classList.remove("show");
});

// FILE UPLOAD
document.getElementById("uploadBtn").addEventListener("click", () => {
  document.getElementById("fileInput").click();
});

document.getElementById("fileInput").addEventListener("change", (e) => {
  const files = [...e.target.files];
  uploadedFiles = files;

  const filePreviews = document.getElementById("filePreviews");
  filePreviews.innerHTML = "";

  files.forEach((file) => {
    const reader = new FileReader();
    reader.onload = () => {
      const box = document.createElement("div");
      box.className = "file-preview";

      const img = document.createElement("img");
      img.src = reader.result;

      const remove = document.createElement("button");
      remove.textContent = "‚úñ";
      remove.onclick = () => box.remove();

      box.appendChild(img);
      box.appendChild(remove);
      filePreviews.appendChild(box);
    };
    reader.readAsDataURL(file);
  });
});
</script>
</body>
</html>
